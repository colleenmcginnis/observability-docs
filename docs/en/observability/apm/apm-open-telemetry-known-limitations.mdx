---
slug: /en/observability/apm-open-telemetry-known-limitations
title: Limitations
description: Description to be written
tags: []
---

<div id="apm-open-telemetry-known-limitations"></div>

<div id="apm-open-telemetry-traces-limitations"></div>

## OpenTelemetry traces

* Traces of applications using `messaging` semantics might be wrongly displayed as `transactions` in the APM UI, while they should be considered `spans` (see issue [#7001](https://github.com/elastic/apm-server/issues/7001)).
* Inability to see Stack traces in spans.
* Inability in APM views to view the "Time Spent by Span Type"  (see issue [#5747](https://github.com/elastic/apm-server/issues/5747)).

<div id="apm-open-telemetry-metrics-limitations"></div>

## OpenTelemetry metrics

* Inability to see host metrics in Elastic Metrics Infrastructure view when using the OpenTelemetry Collector host metrics receiver (see issue [#5310](https://github.com/elastic/apm-server/issues/5310)).

<div id="apm-open-telemetry-logs-intake"></div>

## OpenTelemetry logs

* <DocBadge template="technical preview" />  The OpenTelemetry logs intake via APM Server is in technical preview.
* The application logs data stream (`app_logs`) has dynamic mapping disabled. This means the automatic detection and mapping of new fields is disabled (see issue [#9093](https://github.com/elastic/apm-server/issues/9093)).

<div id="apm-open-telemetry-otlp-limitations"></div>

## OpenTelemetry Line Protocol (OTLP)

APM Server supports both the  [OTLP/gRPC](https://opentelemetry.io/docs/specs/otlp/#otlpgrpc) and [OTLP/HTTP](https://opentelemetry.io/docs/specs/otlp/#otlphttp) protocol with ProtoBuf payload.
APM Server does not yet support JSON Encoding for OTLP/HTTP.

<div id="apm-open-telemetry-collector-exporter"></div>

## OpenTelemetry Collector exporter for Elastic

The [OpenTelemetry Collector exporter for Elastic](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/v0.57.2/exporter/elasticexporter)
has been deprecated and replaced by the native support of the OpenTelemetry Line Protocol in Elastic Observability (OTLP).
{/* To learn more, see [migration](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/v0.57.2/exporter/elasticsearchexporter#migration). */}

The [Elasticsearch exporter for the OpenTelemetry Collector](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/exporter/elasticsearchexporter#elasticsearch-exporter)
(which is different from the legacy exporter mentioned above) is not intended to be used with Elastic APM and Elastic Observability. Use <DocLink slug="/en/observability/apm-open-telemetry-direct">OpenTelemetry native support</DocLink> instead.

<div id="apm-open-telemetry-tbs"></div>

## OpenTelemetry's tail-based sampling

Tail-based sampling allows to make sampling decisions after all spans of a trace have been completed.
This allows for more powerful and informed sampling rules.

When using OpenTelemetry with Elastic APM, there are two different implementations available for tail-based sampling:

* Tail-based sampling using the [tailsamplingprocessor](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor) in the OpenTelemetry Collector
* Native <DocLink slug="/en/observability/apm-sampling" section="tail-based-sampling">tail-based sampling in the Elastic APM backend</DocLink>

Using the [tailsamplingprocessor](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor) in the OpenTelemetry Collector comes with an important limitation. Elastic's APM backend calculates span and transaction metrics based on the incoming span events.
These metrics are accurate for 100% sampling scenarios. In scenarios with probabilistic sampling, Elastic's APM backend is being informed about the sampling rate of spans and can extrapolate throughput metrics based on the incoming, partial data. However, with tail-based sampling there's no clear probability for sampling decisions as the rules can be more complex and the OpenTelemetry Collector does not provide sampling probability information to the Elastic backend that could be used for extrapolation of data. Therefore, there's no way for Elastic APM to properly extrapolate throughput and count metrics that are derived from span events that have been tail-based sampled in the OpenTelemetry Collector. In these scenarios, derived throughput and count metrics are likely to be inaccurate.

Therefore, we recommend using Elastic's native tail-based sampling when integrating with OpenTelemetry.
