---
id: enObservabilityApmPrivilegesApiKey
slug: /en/observability/apm-privileges-api-key
title: Grant privileges and roles needed for API key management
description: Description to be written
tags: []
---

<div id="apm-privileges-api-key"></div>

You can configure <DocLink id="enObservabilityApmApiKey">API keys</DocLink> to authorize requests to APM Server.
To create an APM Server user with the required privileges for creating and managing API keys:

1. Create an **API key role**, called something like `apm_api_key`,
    that has the following `cluster` level privileges:

    | Privilege | Purpose |
    |---|---|
    | `manage_own_api_key` | Allow APM Server to create, retrieve, and invalidate API keys |

1. Depending on what the **API key role** will be used for,
    also assign the appropriate `apm` application-level privileges:

* To **receive Agent configuration**, assign `config_agent:read`.
* To **ingest agent data**, assign `event:write`.
* To **upload source maps**, assign `sourcemap:write`.

1. Assign the **API key role** to users that need to create and manage API keys.
    Users with this role can only create API keys that have the same or lower access rights.

<div id="apm-privileges-api-key-example"></div>

## Example API key role

The following example assigns the required cluster privileges,
and the ingest agent data `apm` API key application privileges to a role named `apm_api_key`:

```kibana
PUT _security/role/apm_api_key  [^1]
{
  "cluster": [
    "manage_own_api_key"  [^2]
  ],
  "applications": [
    {
      "application": "apm",
      "privileges": [
        "event:write"  [^3]
      ],
      "resources": [
        "*"
      ]
    }
  ]
}
```
[^1]: `apm_api_key` is the name of the role we're assigning these privileges to. Any name can be used.
[^2]: Required cluster privileges.
[^3]: Required for API keys that will be used to ingest agent events.

{/*
***  **
***  ** 

*/}

