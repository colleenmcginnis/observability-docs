---
id: enObservabilityApmIntegrationUpgradeSteps
slug: /en/observability/apm-integration-upgrade-steps
title: Switch a self-installation to the APM integration
description: Description to be written
tags: []
---

<div id="apm-integration-upgrade-steps"></div>

1. <DocLink id="enObservabilityApmIntegrationUpgradeSteps" section="upgrade-the-((stack))">Upgrade the ((stack))</DocLink>
1. <DocLink id="enObservabilityApmIntegrationUpgradeSteps" section="add-a-((fleet))-server">Add a ((fleet)) Server</DocLink>
1. <DocLink id="enObservabilityApmIntegrationUpgradeSteps" section="install-a-((fleet))-managed-((agent))">Install a ((fleet))-managed ((agent))</DocLink>
1. <DocLink id="enObservabilityApmIntegrationUpgradeSteps" section="add-the-apm-integration">Add the APM integration</DocLink>
1. <DocLink id="enObservabilityApmIntegrationUpgradeSteps" section="stop-the-apm-server">Stop the APM Server</DocLink>

<div id="apm-integration-upgrade-1"></div>

## Upgrade the ((stack))

The ((stack)) (((es)) and ((kib))) must be upgraded to version 7.14 or higher.
See the [((stack)) Installation and Upgrade Guide](((stack-ref))/upgrading-elastic-stack.html) for guidance.

Review the APM <DocLink id="enObservabilityApmReleaseNotes">release notes</DocLink>, <DocLink id="enObservabilityApmBreaking">breaking changes</DocLink>,
and ((observability)) [What's new](((observability-guide))/whats-new.html) content for important changes between
your current APM version and this one.

<div id="apm-integration-upgrade-2"></div>

## Add a ((fleet)) Server

((fleet)) Server is a component of the ((stack)) used to centrally manage ((agent))s.
The APM integration requires a ((fleet)) Server to be running and accessible to your hosts.
Add a ((fleet)) Server by following [this guide](((fleet-guide))/add-a-fleet-server.html).

<DocCallOut title="Tip">
If you're upgrading a self-managed deployment of the ((stack)), you'll need to enable
[((es)) security](((ref))/configuring-stack-security.html) and the
[API key service](((ref))/security-settings.html).
</DocCallOut>

After adding your ((fleet)) Server host and generating a service token, the in-product help in ((kib))
will provide a command to run to start an ((agent)) as a ((fleet)) Server.
Commands may require administrator privileges.

Verify ((fleet)) Server is running by navigating to **((fleet))** > **Agents** in ((kib)).

<div id="apm-integration-upgrade-3"></div>

## Install a ((fleet))-managed ((agent))

<DocCallOut title="Note">
It's possible to install the Elastic APM integration on the same ((agent)) that is running the ((fleet)) Server integration. For this use case, skip this step.
</DocCallOut>

The ((fleet))-managed ((agent)) will run the Elastic APM integration on your edge nodes, next to your applications.
To install a ((fleet))-managed ((agent)), follow [this guide](((fleet-guide))/install-fleet-managed-elastic-agent.html).

<div id="apm-integration-upgrade-4"></div>

## Add the APM integration

The APM integration receives performance data from your APM agents,
validates and processes it, and then transforms the data into ((es)) documents.

To add the APM integration, see <DocLink id="enObservabilityTracesGetStarted" section="step-1-configure-the-apm-integration">Step 1: Configure the APM integration</DocLink>.
Only complete the linked step (not the entire quick start guide).
If you're adding the APM integration to a ((fleet))-managed ((agent)), you can use the default policy.
If you're adding the APM integration to the ((fleet-server)), use the policy that the ((fleet-server)) is running on.

<DocCallOut title="Tip">
You'll configure the APM integration in this step.
See <DocLink id="enObservabilityApmConfiguringHowtoApmServer">Configure</DocLink> for a reference of all available settings.
As long as the APM integration is configured with the same secret token or you have API keys enabled on the same host,
no reconfiguration is required in your APM agents.
</DocCallOut>

<div id="apm-integration-upgrade-5"></div>

## Stop the APM Server

Once data from upgraded APM agents is visible in the ((apm-app)),
it's safe to stop the APM Server process.

Congratulations -- you now have the latest and greatest in Elastic APM!

{/* ******************************************************** */}

